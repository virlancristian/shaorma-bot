const fs = require('fs');
const path = require('path')

const { timestamp } = require('helpers/modules/time');
const { logTypeArgument } = require('helpers/modules/disambiguate');

function addLogToFile(time, logType, message) {
    const date = timestamp.date();
    const logmessage = `(${time}) ${logType}:${message}\n`;

    try {
        const resolveFilePath = path.resolve(__dirname, `store/${date}.log`);
        fs.appendFileSync(resolveFilePath, logmessage);
    } catch (error) {
        displayLog(timestamp.time(), 'Error', error);
    }
}

function displayLog(time, logType, message) {
    console.log(`(${time}) ${logType}:${message}`);
}

function log(logObject) {
    const sanitizedLogType = !logObject.logType ? `Log` : logTypeArgument(logObject.logType);
    const time = timestamp.time();

    displayLog(time, sanitizedLogType, logObject.message);
    addLogToFile(time, sanitizedLogType, logObject.message);
}

module.exports = {
    logger: {
        log: log
    }
};